name: ADDRESS EXE
on: [push]  
jobs:
  job1:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: ADDRESS EXE
      run: |
         dir project/main
         cd project/main
         g++ -o address2024-test address2024-test.cpp
         ./address2024-test > input-address.txt
         cat input-address.txt
#      shell: cmd
    - name: Upload outline
      uses: actions/upload-artifact@v4
      with:
        name: input-address
        path: project/main/input-address.txt
  job2:
    needs: job1
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    - name: Download output
      uses: actions/download-artifact@v4
      with:
        name: input-address
        path: project/main/input-address.txt
    - name: Run another C++ code
      run: |
         ls project/main
         cd project/main
         g++ -o address2024test-in address2024test-in.cpp
         ./address2024test-in < input-address.txt > output-address.txt
         cat output-address.txt
 #     shell: cmd
    - name: Upload output
      uses: actions/upload-artifact@v4
      with:
        name: output-address
        path: project/main/output-address.txt
    - name: output-address
      run: |
         ls project/main
         cd project/main
         cat output-address.txt
  #    shell: cmd
  job3:
    needs:  [job1, job2]
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    - name: Download outline
      uses: actions/download-artifact@v4
      with:
         name: input-address
         path: project/main/input-address.txt
    - name: Download output
      uses: actions/download-artifact@v4
      with:
        name: output-address
        path: project/main/output-address.txt
    - name: Compare files
      run: |
         ls project/main
         cat project/main/output-address.txt/output-address.txt
         cat project/main/input-address.txt/input-address.txt
#         diff -c project/main/output-address.txt/output-address.txt project/main/input-address.txt/input-address.txt

#        cd project/main/
#        ls output-address.txt
#        cat project/main/output-address.txt/output-address.txt
#        diff input-address.txt output-address.txt
#          if [ -s diff_output.txt ]; then
#            echo "Differences found:"
#            cat diff_output.txt
#          else
#            echo "No differences found."
